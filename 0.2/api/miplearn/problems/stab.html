<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.0" />
<title>miplearn.problems.stab API documentation</title>
<meta name="description" content="" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>miplearn.problems.stab</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#  MIPLearn: Extensible Framework for Learning-Enhanced Mixed-Integer Optimization
#  Copyright (C) 2020, UChicago Argonne, LLC. All rights reserved.
#  Released under the modified BSD license. See COPYING.md for more details.

import networkx as nx
import numpy as np
import pyomo.environ as pe
from scipy.stats import uniform, randint
from scipy.stats.distributions import rv_frozen

from miplearn.instance import Instance


class ChallengeA:
    def __init__(
        self,
        seed=42,
        n_training_instances=500,
        n_test_instances=50,
    ):

        np.random.seed(seed)
        self.generator = MaxWeightStableSetGenerator(
            w=uniform(loc=100.0, scale=50.0),
            n=randint(low=200, high=201),
            p=uniform(loc=0.05, scale=0.0),
            fix_graph=True,
        )

        np.random.seed(seed + 1)
        self.training_instances = self.generator.generate(n_training_instances)

        np.random.seed(seed + 2)
        self.test_instances = self.generator.generate(n_test_instances)


class MaxWeightStableSetGenerator:
    &#34;&#34;&#34;Random instance generator for the Maximum-Weight Stable Set Problem.

    The generator has two modes of operation. When `fix_graph=True` is provided, one random
    Erdős-Rényi graph $G_{n,p}$ is generated in the constructor, where $n$ and $p$ are sampled
    from user-provided probability distributions `n` and `p`. To generate each instance, the
    generator independently samples each $w_v$ from the user-provided probability distribution `w`.

    When `fix_graph=False`, a new random graph is generated for each instance; the remaining
    parameters are sampled in the same way.
    &#34;&#34;&#34;

    def __init__(
        self,
        w=uniform(loc=10.0, scale=1.0),
        n=randint(low=250, high=251),
        p=uniform(loc=0.05, scale=0.0),
        fix_graph=True,
    ):
        &#34;&#34;&#34;Initialize the problem generator.

        Parameters
        ----------
        w: rv_continuous
            Probability distribution for vertex weights.
        n: rv_discrete
            Probability distribution for parameter $n$ in Erdős-Rényi model.
        p: rv_continuous
            Probability distribution for parameter $p$ in Erdős-Rényi model.
        &#34;&#34;&#34;
        assert isinstance(w, rv_frozen), &#34;w should be a SciPy probability distribution&#34;
        assert isinstance(n, rv_frozen), &#34;n should be a SciPy probability distribution&#34;
        assert isinstance(p, rv_frozen), &#34;p should be a SciPy probability distribution&#34;
        self.w = w
        self.n = n
        self.p = p
        self.fix_graph = fix_graph
        self.graph = None
        if fix_graph:
            self.graph = self._generate_graph()

    def generate(self, n_samples):
        def _sample():
            if self.graph is not None:
                graph = self.graph
            else:
                graph = self._generate_graph()
            weights = self.w.rvs(graph.number_of_nodes())
            return MaxWeightStableSetInstance(graph, weights)

        return [_sample() for _ in range(n_samples)]

    def _generate_graph(self):
        return nx.generators.random_graphs.binomial_graph(self.n.rvs(), self.p.rvs())


class MaxWeightStableSetInstance(Instance):
    &#34;&#34;&#34;An instance of the Maximum-Weight Stable Set Problem.

    Given a graph G=(V,E) and a weight w_v for each vertex v, the problem asks for a stable
    set S of G maximizing sum(w_v for v in S). A stable set (also called independent set) is
    a subset of vertices, no two of which are adjacent.

    This is one of Karp&#39;s 21 NP-complete problems.
    &#34;&#34;&#34;

    def __init__(self, graph, weights):
        super().__init__()
        self.graph = graph
        self.weights = weights

    def to_model(self):
        nodes = list(self.graph.nodes)
        model = pe.ConcreteModel()
        model.x = pe.Var(nodes, domain=pe.Binary)
        model.OBJ = pe.Objective(
            expr=sum(model.x[v] * self.weights[v] for v in nodes), sense=pe.maximize
        )
        model.clique_eqs = pe.ConstraintList()
        for clique in nx.find_cliques(self.graph):
            model.clique_eqs.add(sum(model.x[i] for i in clique) &lt;= 1)
        return model

    def get_instance_features(self):
        return np.ones(0)

    def get_variable_features(self, var, index):
        neighbor_weights = [0] * 15
        neighbor_degrees = [100] * 15
        for n in self.graph.neighbors(index):
            neighbor_weights += [self.weights[n] / self.weights[index]]
            neighbor_degrees += [self.graph.degree(n) / self.graph.degree(index)]
        neighbor_weights.sort(reverse=True)
        neighbor_degrees.sort()
        features = []
        features += neighbor_weights[:5]
        features += neighbor_degrees[:5]
        features += [self.graph.degree(index)]
        return np.array(features)

    def get_variable_category(self, var, index):
        return &#34;default&#34;</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="miplearn.problems.stab.ChallengeA"><code class="flex name class">
<span>class <span class="ident">ChallengeA</span></span>
<span>(</span><span>seed=42, n_training_instances=500, n_test_instances=50)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ChallengeA:
    def __init__(
        self,
        seed=42,
        n_training_instances=500,
        n_test_instances=50,
    ):

        np.random.seed(seed)
        self.generator = MaxWeightStableSetGenerator(
            w=uniform(loc=100.0, scale=50.0),
            n=randint(low=200, high=201),
            p=uniform(loc=0.05, scale=0.0),
            fix_graph=True,
        )

        np.random.seed(seed + 1)
        self.training_instances = self.generator.generate(n_training_instances)

        np.random.seed(seed + 2)
        self.test_instances = self.generator.generate(n_test_instances)</code></pre>
</details>
</dd>
<dt id="miplearn.problems.stab.MaxWeightStableSetGenerator"><code class="flex name class">
<span>class <span class="ident">MaxWeightStableSetGenerator</span></span>
<span>(</span><span>w=<scipy.stats._distn_infrastructure.rv_frozen object>, n=<scipy.stats._distn_infrastructure.rv_frozen object>, p=<scipy.stats._distn_infrastructure.rv_frozen object>, fix_graph=True)</span>
</code></dt>
<dd>
<section class="desc"><p>Random instance generator for the Maximum-Weight Stable Set Problem.</p>
<p>The generator has two modes of operation. When <code>fix_graph=True</code> is provided, one random
Erdős-Rényi graph $G_{n,p}$ is generated in the constructor, where $n$ and $p$ are sampled
from user-provided probability distributions <code>n</code> and <code>p</code>. To generate each instance, the
generator independently samples each $w_v$ from the user-provided probability distribution <code>w</code>.</p>
<p>When <code>fix_graph=False</code>, a new random graph is generated for each instance; the remaining
parameters are sampled in the same way.</p>
<p>Initialize the problem generator.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>w</code></strong> :&ensp;<code>rv_continuous</code></dt>
<dd>Probability distribution for vertex weights.</dd>
<dt><strong><code>n</code></strong> :&ensp;<code>rv_discrete</code></dt>
<dd>Probability distribution for parameter $n$ in Erdős-Rényi model.</dd>
<dt><strong><code>p</code></strong> :&ensp;<code>rv_continuous</code></dt>
<dd>Probability distribution for parameter $p$ in Erdős-Rényi model.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MaxWeightStableSetGenerator:
    &#34;&#34;&#34;Random instance generator for the Maximum-Weight Stable Set Problem.

    The generator has two modes of operation. When `fix_graph=True` is provided, one random
    Erdős-Rényi graph $G_{n,p}$ is generated in the constructor, where $n$ and $p$ are sampled
    from user-provided probability distributions `n` and `p`. To generate each instance, the
    generator independently samples each $w_v$ from the user-provided probability distribution `w`.

    When `fix_graph=False`, a new random graph is generated for each instance; the remaining
    parameters are sampled in the same way.
    &#34;&#34;&#34;

    def __init__(
        self,
        w=uniform(loc=10.0, scale=1.0),
        n=randint(low=250, high=251),
        p=uniform(loc=0.05, scale=0.0),
        fix_graph=True,
    ):
        &#34;&#34;&#34;Initialize the problem generator.

        Parameters
        ----------
        w: rv_continuous
            Probability distribution for vertex weights.
        n: rv_discrete
            Probability distribution for parameter $n$ in Erdős-Rényi model.
        p: rv_continuous
            Probability distribution for parameter $p$ in Erdős-Rényi model.
        &#34;&#34;&#34;
        assert isinstance(w, rv_frozen), &#34;w should be a SciPy probability distribution&#34;
        assert isinstance(n, rv_frozen), &#34;n should be a SciPy probability distribution&#34;
        assert isinstance(p, rv_frozen), &#34;p should be a SciPy probability distribution&#34;
        self.w = w
        self.n = n
        self.p = p
        self.fix_graph = fix_graph
        self.graph = None
        if fix_graph:
            self.graph = self._generate_graph()

    def generate(self, n_samples):
        def _sample():
            if self.graph is not None:
                graph = self.graph
            else:
                graph = self._generate_graph()
            weights = self.w.rvs(graph.number_of_nodes())
            return MaxWeightStableSetInstance(graph, weights)

        return [_sample() for _ in range(n_samples)]

    def _generate_graph(self):
        return nx.generators.random_graphs.binomial_graph(self.n.rvs(), self.p.rvs())</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="miplearn.problems.stab.MaxWeightStableSetGenerator.generate"><code class="name flex">
<span>def <span class="ident">generate</span></span>(<span>self, n_samples)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate(self, n_samples):
    def _sample():
        if self.graph is not None:
            graph = self.graph
        else:
            graph = self._generate_graph()
        weights = self.w.rvs(graph.number_of_nodes())
        return MaxWeightStableSetInstance(graph, weights)

    return [_sample() for _ in range(n_samples)]</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="miplearn.problems.stab.MaxWeightStableSetInstance"><code class="flex name class">
<span>class <span class="ident">MaxWeightStableSetInstance</span></span>
<span>(</span><span>graph, weights)</span>
</code></dt>
<dd>
<section class="desc"><p>An instance of the Maximum-Weight Stable Set Problem.</p>
<p>Given a graph G=(V,E) and a weight w_v for each vertex v, the problem asks for a stable
set S of G maximizing sum(w_v for v in S). A stable set (also called independent set) is
a subset of vertices, no two of which are adjacent.</p>
<p>This is one of Karp's 21 NP-complete problems.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MaxWeightStableSetInstance(Instance):
    &#34;&#34;&#34;An instance of the Maximum-Weight Stable Set Problem.

    Given a graph G=(V,E) and a weight w_v for each vertex v, the problem asks for a stable
    set S of G maximizing sum(w_v for v in S). A stable set (also called independent set) is
    a subset of vertices, no two of which are adjacent.

    This is one of Karp&#39;s 21 NP-complete problems.
    &#34;&#34;&#34;

    def __init__(self, graph, weights):
        super().__init__()
        self.graph = graph
        self.weights = weights

    def to_model(self):
        nodes = list(self.graph.nodes)
        model = pe.ConcreteModel()
        model.x = pe.Var(nodes, domain=pe.Binary)
        model.OBJ = pe.Objective(
            expr=sum(model.x[v] * self.weights[v] for v in nodes), sense=pe.maximize
        )
        model.clique_eqs = pe.ConstraintList()
        for clique in nx.find_cliques(self.graph):
            model.clique_eqs.add(sum(model.x[i] for i in clique) &lt;= 1)
        return model

    def get_instance_features(self):
        return np.ones(0)

    def get_variable_features(self, var, index):
        neighbor_weights = [0] * 15
        neighbor_degrees = [100] * 15
        for n in self.graph.neighbors(index):
            neighbor_weights += [self.weights[n] / self.weights[index]]
            neighbor_degrees += [self.graph.degree(n) / self.graph.degree(index)]
        neighbor_weights.sort(reverse=True)
        neighbor_degrees.sort()
        features = []
        features += neighbor_weights[:5]
        features += neighbor_degrees[:5]
        features += [self.graph.degree(index)]
        return np.array(features)

    def get_variable_category(self, var, index):
        return &#34;default&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="miplearn.instance.Instance" href="../instance.html#miplearn.instance.Instance">Instance</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="miplearn.instance.Instance" href="../instance.html#miplearn.instance.Instance">Instance</a></b></code>:
<ul class="hlist">
<li><code><a title="miplearn.instance.Instance.build_lazy_constraint" href="../instance.html#miplearn.instance.Instance.build_lazy_constraint">build_lazy_constraint</a></code></li>
<li><code><a title="miplearn.instance.Instance.find_violated_lazy_constraints" href="../instance.html#miplearn.instance.Instance.find_violated_lazy_constraints">find_violated_lazy_constraints</a></code></li>
<li><code><a title="miplearn.instance.Instance.get_instance_features" href="../instance.html#miplearn.instance.Instance.get_instance_features">get_instance_features</a></code></li>
<li><code><a title="miplearn.instance.Instance.get_variable_category" href="../instance.html#miplearn.instance.Instance.get_variable_category">get_variable_category</a></code></li>
<li><code><a title="miplearn.instance.Instance.get_variable_features" href="../instance.html#miplearn.instance.Instance.get_variable_features">get_variable_features</a></code></li>
<li><code><a title="miplearn.instance.Instance.to_model" href="../instance.html#miplearn.instance.Instance.to_model">to_model</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="miplearn.problems" href="index.html">miplearn.problems</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="miplearn.problems.stab.ChallengeA" href="#miplearn.problems.stab.ChallengeA">ChallengeA</a></code></h4>
</li>
<li>
<h4><code><a title="miplearn.problems.stab.MaxWeightStableSetGenerator" href="#miplearn.problems.stab.MaxWeightStableSetGenerator">MaxWeightStableSetGenerator</a></code></h4>
<ul class="">
<li><code><a title="miplearn.problems.stab.MaxWeightStableSetGenerator.generate" href="#miplearn.problems.stab.MaxWeightStableSetGenerator.generate">generate</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="miplearn.problems.stab.MaxWeightStableSetInstance" href="#miplearn.problems.stab.MaxWeightStableSetInstance">MaxWeightStableSetInstance</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.0</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>